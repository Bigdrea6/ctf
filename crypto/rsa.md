# About
CTFにおける最頻の公開鍵暗号.  
素因数分解の困難性を安全の根拠としている.  

# 仕組み
## パラメータの決定
 - p,q:素数
 - n:$\begin{equation} n = pq\end{equation}$
 - e:$\phi_{(n)}$と互いに素となる  

また, 一般的にeの値として0x10001(65537)が採用されることが多い.  
なおここで, $\phi_{(n)}$とはオイラーのφ関数である. 整数nに対し, 1~n-1までの自然数のうちnと互いに素なものの個数を表す.  
この関数は以下の2つの性質を持つ.  

 - xが素数であるとき$\phi_{(x)}=x-1$となる
 - $x=ab$と素因数分解できるとき, $\phi_{(x)}=\phi_{(a)}\phi_{(b)}$となる   
 
これらより, RSA暗号において$\phi_{(n)}=(p-1)(q-1)$となる.  
次に, 先ほどのパラメータよりもう1つのパラメータ, dを求める.  
$d\equiv e^{-1} \pmod{\phi_{(n)}}$ として計算される.  
なおここでdはeの逆元として計算されるが, eと$\phi_{(n)}$が互いに素でないとき逆元は計算できない.  
ここまでで求めた各パラメータのうち,  
  
 - n,e: 公開鍵
 - d,(p,q): 秘密鍵
 
となる. p,qはこの後の手順に必要ないため破棄することが多いが, 知られてはいけないという点から秘密鍵としている.  

## 暗号化
平文をmとしたとき, 暗号文cは以下の式によって求まる.  
$c = m^{e} \pmod{n}$  

## 復号
暗号文をcとしたとき, 平文mは以下の式によって求まる.  
$m = c^{d} \pmod{n}$  

## なぜ復号できるか
### オイラーの定理       
```
ある正の整数nがあり, $x\in\mathbb{z}$のとき, xとnが互いに素ならば  $x^{\phi_{(n)}} \equiv 1 \pmod{n}$
```

これを踏まえ, 復号処理を式変形する.  
$\begin{align} c^{d} \pmod{n} &= (m^{e})^d \pmod{n} \\ &= m^{ed} \pmod{n} \\ &= m^{1+k\phi_{(n)}} \pmod{n} \\ &= m^{1}・m^{k\phi_{(n)}} \pmod{n} \\ &= m・1 \pmod{n} \\ &= m \pmod{n} \end{align}$  
以上より復号できることが示せた.  

### サンプル
<script src="https://gist.github.com/iero-kyuri/2b6c4e564625598473989bcfe38ca2fe.js"></script>